<link rel="import" href="../bower_components/polymer/polymer.html">
<polymer-element name="labeli-user" on-click="click">
	<template>
		<style>
			:host
			{
				display : flex;
				/*box-shadow : 0px 1px 3px rgba(0,0,0,0.2);*/
				margin : 3px;
				flex-grow : 1;
				flex-shrink : 0;
				flex-basis : 180px;
				flex-direction: row;
				flex-wrap : nowrap;
				box-sizing: border-box;
				overflow: hidden;
				cursor : pointer;
				background-color: #232323;
				border : 2px solid #232323;
				color : #afbfff;
			}
			:host([big])
			{
				max-width: 1000px;
				margin : 10px auto;
			}
			:host([big]) #description
			{
				padding : 10px;
				display : block;
			}
			#description
			{
				display : none;
				color : white;
			}
			h2
			{
				font-size : 1em;
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
				margin : 0px 0px;
				font-weight: 700;
			}
			#imgbox
			{
				flex-shrink : 0;
				width : 64px;
				height : 64px;
				overflow :hidden;
				background-image : url('http://labeli.org/images/background.png');
			}
			.info
			{
				padding : 10px;
				padding-bottom : 5px;
				margin-bottom : 0px;
			}
		</style>
		
		<template bind if="{{loginBox}}">
			<template bind if="{{!user}}">
				<div on-click="{{goToLogin}}">Connexion</div>
			</template>
			<template bind if="{{user}}">
				test : {{user.id}}
			</template>
		</template>
		
		
		<template bind if="{{!loginBox}}">
			<template bind if="{{user.picture}}">
				<div id="imgbox" style="background-image : url('http://labeli.org/{{user.picture}}'); background-size: cover;"></div>
			</template>
			<template bind if="{{user.picture == ''}}">
				<div id="imgbox"></div>
			</template>

			<div class="info">
				<h2>{{user.firstName}}<br />{{user.lastName}}</h2>
			</div>
		</template>
		
	</template>
	
	<script>
		Polymer({
			publish : 
			{
				big : false,
				loginBox : false,
			},
			user : null,
			userChanged : function()
			{
				this.$.description.innerHTML = this.user.description;
			},
			click : function()
			{
				var user = document.querySelector("#section-user labeli-user");
				user.user = this.user;

				router.go("user", {id : this.user.id});
			},
			loadId : null,
			loadIdChanged : function()
			{
				var userElement = this;
				labeli.async.getUser(this.loadId, function(user)
				{
					userElement.user = user;
				});
			},
			goToLogin : function()
			{
				console.log("test");
				router.go("login", {});
			}
		});
	</script>
</polymer-element>